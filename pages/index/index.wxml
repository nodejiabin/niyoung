<!--pages/index/index.wxml-->
<view class="page-container">
  <!-- æœç´¢æ¡† -->
  <view class="search-container">
    <view class="search-box">
      <icon class="search-icon" type="search" size="16"></icon>
      <input class="search-input" placeholder="æœç´¢çˆ±è½¦åˆ†äº«..." bindinput="onSearchInput" value="{{searchValue}}" />
    </view>
  </view>

  <!-- è½®æ’­å›¾ -->
  <view class="banner-container">
    <swiper class="banner-swiper" indicator-dots="{{true}}" autoplay="{{true}}" interval="{{5000}}" duration="{{1000}}">
      <block wx:for="{{banners}}" wx:key="id">
        <swiper-item>
          <image class="banner-image" src="{{item.image}}" mode="aspectFill" />
        </swiper-item>
      </block>
    </swiper>
  </view>

  <!-- åˆ†ç±»å¯¼èˆª -->
  <view class="category-container">
    <view class="category-title">çƒ­é—¨åˆ†ç±»</view>
    <view class="category-list">
      <block wx:for="{{categories}}" wx:key="id">
        <view class="category-item" bindtap="onCategoryTap" data-category="{{item.name}}">
          <view class="category-icon">{{item.icon}}</view>
          <view class="category-name">{{item.name}}</view>
        </view>
      </block>
    </view>
  </view>

  <!-- åˆ†äº«å†…å®¹åˆ—è¡¨ -->
  <view class="content-container">
    <view class="content-header">
      <view class="content-title">æœ€æ–°åˆ†äº«</view>
      <view class="content-filter">
        <view class="filter-item {{currentFilter === 'latest' ? 'active' : ''}}" bindtap="onFilterTap" data-filter="latest">æœ€æ–°</view>
        <view class="filter-item {{currentFilter === 'hot' ? 'active' : ''}}" bindtap="onFilterTap" data-filter="hot">æœ€çƒ­</view>
      </view>
    </view>

    <!-- å†…å®¹åˆ—è¡¨ -->
    <view class="content-list">
      <block wx:for="{{contentList}}" wx:key="id">
        <view class="content-item card" bindtap="onContentTap" data-id="{{item.id}}">
          <!-- ç”¨æˆ·ä¿¡æ¯ -->
          <view class="user-info">
            <image class="user-avatar avatar" src="{{item.userAvatar}}" mode="aspectFill" />
            <view class="user-details">
              <view class="user-name">{{item.userName}}</view>
              <view class="post-time text-light">{{item.createTime}}</view>
            </view>
          </view>

          <!-- å†…å®¹æ–‡æœ¬ -->
          <view class="content-text">{{item.content}}</view>

          <!-- å›¾ç‰‡åˆ—è¡¨ -->
          <view class="content-images" wx:if="{{item.images && item.images.length > 0}}">
            <block wx:for="{{item.images}}" wx:key="index" wx:for-item="imageUrl">
              <image class="content-image" src="{{imageUrl}}" mode="aspectFill" bindtap="onImageTap" data-urls="{{item.images}}" data-current="{{imageUrl}}" />
            </block>
          </view>

          <!-- è½¦è¾†ä¿¡æ¯ -->
          <view class="car-info" wx:if="{{item.carInfo}}">
            <view class="car-brand">{{item.carInfo.brand}} {{item.carInfo.model}}</view>
            <view class="car-year text-light">{{item.carInfo.year}}å¹´</view>
          </view>

          <!-- æ“ä½œæŒ‰é’® -->
          <view class="action-bar">
            <view class="action-item" bindtap="onLikeTap" data-id="{{item.id}}" data-liked="{{item.isLiked}}">
              <icon class="action-icon" type="{{item.isLiked ? 'success' : 'circle'}}" size="16" color="{{item.isLiked ? '#2E86AB' : '#999'}}"></icon>
              <text class="action-text {{item.isLiked ? 'text-primary' : 'text-light'}}">{{item.likeCount}}</text>
            </view>
            <view class="action-item" bindtap="onCollectTap" data-id="{{item.id}}" data-collected="{{item.isCollected}}">
              <icon class="action-icon" type="{{item.isCollected ? 'success' : 'circle'}}" size="16" color="{{item.isCollected ? '#2E86AB' : '#999'}}"></icon>
              <text class="action-text {{item.isCollected ? 'text-primary' : 'text-light'}}">{{item.collectCount}}</text>
            </view>
            <view class="action-item" bindtap="onShareTap" data-id="{{item.id}}">
              <icon class="action-icon" type="circle" size="16" color="#999"></icon>
              <text class="action-text text-light">åˆ†äº«</text>
            </view>
          </view>
        </view>
      </block>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more" wx:if="{{hasMore}}">
      <view class="loading" wx:if="{{loading}}">åŠ è½½ä¸­...</view>
      <view class="load-more-btn" wx:else bindtap="loadMore">åŠ è½½æ›´å¤š</view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty" wx:if="{{!contentList.length && !loading}}">
      <view class="empty-icon">ðŸš—</view>
      <view class="empty-text">æš‚æ— åˆ†äº«å†…å®¹</view>
    </view>
  </view>
</view> 