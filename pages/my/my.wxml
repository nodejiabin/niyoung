<!--pages/my/my.wxml-->
<view class="page-container">
  <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
  <view class="user-section card">
    <view class="user-header" wx:if="{{userInfo}}">
      <image class="user-avatar avatar-large" src="{{userInfo.avatarUrl}}" mode="aspectFill" />
      <view class="user-info">
        <view class="user-name">{{userInfo.nickName}}</view>
        <view class="user-desc text-light">åˆ†äº«ç”Ÿæ´»ï¼Œè®°å½•ç¾å¥½</view>
      </view>
      <view class="user-stats">
        <view class="stat-item">
          <view class="stat-number">{{userStats.shareCount}}</view>
          <view class="stat-label">åˆ†äº«</view>
        </view>
        <view class="stat-item">
          <view class="stat-number">{{userStats.likeCount}}</view>
          <view class="stat-label">è·èµ</view>
        </view>
        <view class="stat-item">
          <view class="stat-number">{{userStats.collectCount}}</view>
          <view class="stat-label">æ”¶è—</view>
        </view>
      </view>
    </view>
    
    <!-- æœªç™»å½•çŠ¶æ€ -->
    <view class="login-prompt" wx:else>
      <icon class="login-icon" type="person" size="48" color="#999"></icon>
      <text class="login-text">ç‚¹å‡»ç™»å½•ï¼Œå¼€å§‹åˆ†äº«ä½ çš„çˆ±è½¦</text>
      <button class="login-btn btn btn-primary" bindtap="onLogin">å¾®ä¿¡ç™»å½•</button>
    </view>
  </view>

  <!-- æˆ‘çš„çˆ±è½¦åŒºåŸŸ -->
  <view class="car-section card" wx:if="{{userInfo}}">
    <view class="section-header">
      <view class="section-title">æˆ‘çš„çˆ±è½¦</view>
      <view class="section-action" bindtap="onAddCar">
        <icon type="plus" size="16" color="#2E86AB"></icon>
        <text class="action-text">æ·»åŠ </text>
      </view>
    </view>
    
    <view class="car-list" wx:if="{{carList.length > 0}}">
      <block wx:for="{{carList}}" wx:key="id">
        <view class="car-item" bindtap="onCarTap" data-id="{{item.id}}">
          <image class="car-image" src="{{item.image}}" mode="aspectFill" />
          <view class="car-details">
            <view class="car-name">{{item.brand}} {{item.model}}</view>
            <view class="car-year text-light">{{item.year}}å¹´ Â· {{item.color}}</view>
            <view class="car-mileage text-light">é‡Œç¨‹ï¼š{{item.mileage}}km</view>
          </view>
          <view class="car-actions">
            <icon type="edit" size="16" color="#2E86AB" bindtap="onEditCar" data-id="{{item.id}}"></icon>
          </view>
        </view>
      </block>
    </view>
    
    <view class="empty-car" wx:else>
      <view class="empty-icon">ğŸš—</view>
      <view class="empty-text">è¿˜æ²¡æœ‰æ·»åŠ çˆ±è½¦ä¿¡æ¯</view>
      <button class="add-car-btn btn btn-outline btn-small" bindtap="onAddCar">æ·»åŠ çˆ±è½¦</button>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå•åŒºåŸŸ -->
  <view class="menu-section card" wx:if="{{userInfo}}">
    <view class="menu-list">
      <view class="menu-item" bindtap="onMenuTap" data-type="myShares">
        <icon class="menu-icon" type="share" size="20" color="#2E86AB"></icon>
        <text class="menu-text">æˆ‘çš„åˆ†äº«</text>
        <view class="menu-badge" wx:if="{{userStats.shareCount > 0}}">{{userStats.shareCount}}</view>
        <icon class="menu-arrow" type="arrow" size="16" color="#999"></icon>
      </view>
      
      <view class="menu-item" bindtap="onMenuTap" data-type="myLikes">
        <icon class="menu-icon" type="like" size="20" color="#FF6B6B"></icon>
        <text class="menu-text">æˆ‘çš„ç‚¹èµ</text>
        <view class="menu-badge" wx:if="{{userStats.myLikeCount > 0}}">{{userStats.myLikeCount}}</view>
        <icon class="menu-arrow" type="arrow" size="16" color="#999"></icon>
      </view>
      
      <view class="menu-item" bindtap="onMenuTap" data-type="myCollects">
        <icon class="menu-icon" type="collect" size="20" color="#FFB84D"></icon>
        <text class="menu-text">æˆ‘çš„æ”¶è—</text>
        <view class="menu-badge" wx:if="{{userStats.myCollectCount > 0}}">{{userStats.myCollectCount}}</view>
        <icon class="menu-arrow" type="arrow" size="16" color="#999"></icon>
      </view>
      
      <view class="menu-item" bindtap="onMenuTap" data-type="maintenance">
        <icon class="menu-icon" type="tool" size="20" color="#4ECDC4"></icon>
        <text class="menu-text">ä¿å…»è®°å½•</text>
        <icon class="menu-arrow" type="arrow" size="16" color="#999"></icon>
      </view>
      
      <view class="menu-item" bindtap="onMenuTap" data-type="settings">
        <icon class="menu-icon" type="settings" size="20" color="#95A5A6"></icon>
        <text class="menu-text">è®¾ç½®</text>
        <icon class="menu-arrow" type="arrow" size="16" color="#999"></icon>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘æ´»åŠ¨åŒºåŸŸ -->
  <view class="activity-section card" wx:if="{{userInfo && recentActivities.length > 0}}">
    <view class="section-header">
      <view class="section-title">æœ€è¿‘æ´»åŠ¨</view>
      <view class="section-action" bindtap="onViewAllActivities">
        <text class="action-text">æŸ¥çœ‹å…¨éƒ¨</text>
        <icon type="arrow" size="16" color="#2E86AB"></icon>
      </view>
    </view>
    
    <view class="activity-list">
      <block wx:for="{{recentActivities}}" wx:key="id">
        <view class="activity-item">
          <view class="activity-icon">
            <icon type="{{item.type === 'like' ? 'like' : item.type === 'collect' ? 'collect' : 'share'}}" size="16" color="{{item.type === 'like' ? '#FF6B6B' : item.type === 'collect' ? '#FFB84D' : '#2E86AB'}}"></icon>
          </view>
          <view class="activity-content">
            <view class="activity-text">{{item.content}}</view>
            <view class="activity-time text-light">{{item.time}}</view>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- åº•éƒ¨ä¿¡æ¯ -->
  <view class="footer-section" wx:if="{{userInfo}}">
    <view class="footer-item" bindtap="onAbout">
      <text class="footer-text">å…³äºæˆ‘ä»¬</text>
    </view>
    <view class="footer-item" bindtap="onFeedback">
      <text class="footer-text">æ„è§åé¦ˆ</text>
    </view>
    <view class="footer-item" bindtap="onLogout">
      <text class="footer-text logout-text">é€€å‡ºç™»å½•</text>
    </view>
  </view>
</view> 